# 小程序域名配置说明

## 问题描述
小程序端出现网络请求超时错误，云端后台没有收到请求，这通常是由于域名白名单配置问题。

## 解决方案

### 1. 微信公众平台配置
需要在微信公众平台配置合法域名：

1. 登录微信公众平台：https://mp.weixin.qq.com/
2. 选择你的小程序
3. 进入"开发" -> "开发管理" -> "开发设置"
4. 在"服务器域名"部分添加以下域名：

#### request合法域名
```
https://wxmall.shop
```

#### socket合法域名（如果需要）
```
wss://wxmall.shop
```

### 2. 开发环境配置
在开发工具中，确保以下设置：

1. 项目设置中 `urlCheck` 设置为 `false`
2. 勾选"不校验合法域名、web-view（业务域名）、TLS 版本以及 HTTPS 证书"

### 3. 测试步骤
1. 配置域名后，重新编译小程序
2. 清除缓存并重新运行
3. 检查网络请求是否正常

### 4. 注意事项
- 域名必须是 HTTPS
- 域名不能使用 IP 地址
- 域名不能带端口号
- 一个月内最多可申请修改域名白名单 5 次

## 临时解决方案
如果暂时无法配置域名，可以：
1. 在开发工具中勾选"不校验合法域名"
2. 使用模拟数据进行开发测试
3. 部署时再配置正式域名

## 故障排除

### 如果配置域名后仍然失败：

1. **检查域名格式**
   - 确保域名格式正确：`https://wxmall.shop`
   - 不要包含路径，只配置域名部分

2. **等待生效时间**
   - 域名配置可能需要几分钟到几小时生效
   - 建议等待30分钟后重新测试

3. **清除缓存**
   - 在开发工具中清除缓存
   - 重新编译小程序

4. **检查网络环境**
   - 确保网络连接正常

5. **验证后端服务**
   - 在浏览器中访问：`https://wxmall.shop/health`
   - 确保返回正常响应

### 常见错误及解决方案：

- **request:fail timeout** - 请求超时
  - 检查网络连接
  - 增加请求超时时间
  - 确认域名配置正确

- **request:fail** - 请求失败
  - 检查域名白名单配置
  - 确认后端服务正常运行
  - 验证HTTPS证书有效

- **域名不在白名单中**
  - 重新配置域名白名单
  - 等待配置生效
  - 在开发工具中勾选"不校验合法域名"

## 联系支持
如果问题仍然存在，请：
1. 检查微信公众平台的最新文档
2. 联系微信小程序技术支持
3. 查看Vercel部署状态 